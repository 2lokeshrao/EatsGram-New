# ЁЯЪА MySQL Integration - Quick Start Guide

EatsGram рдореЗрдВ MySQL рдХреЛ 30 рдорд┐рдирдЯ рдореЗрдВ setup рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП guideред

---

## тЪб 5-Minute Setup

### Step 1: MySQL Install рдХрд░реЗрдВ (5 рдорд┐рдирдЯ)

#### Windows:
```bash
# Download рдХрд░реЗрдВ: https://dev.mysql.com/downloads/mysql/
# рдпрд╛ Chocolatey рд╕реЗ:
choco install mysql
```

#### macOS:
```bash
brew install mysql
brew services start mysql
```

#### Linux:
```bash
sudo apt-get update
sudo apt-get install mysql-server
sudo mysql_secure_installation
```

### Verify рдХрд░реЗрдВ:
```bash
mysql --version
mysql -u root -p
```

---

## ЁЯФз Backend Setup (10 рдорд┐рдирдЯ)

### Step 1: Packages Install рдХрд░реЗрдВ

```bash
cd EatsGram-backend

# Sequelize рдХреЗ рд╕рд╛рде (Recommended)
npm install sequelize mysql2

# рдпрд╛ TypeORM рдХреЗ рд╕рд╛рде
npm install typeorm mysql
```

### Step 2: Environment Variables Setup

```bash
# .env file рдореЗрдВ add рдХрд░реЗрдВ:

DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=eatsgram_db
DB_DIALECT=mysql
DB_POOL_MAX=10
DB_POOL_MIN=2
DB_LOGGING=false
```

### Step 3: Database Create рдХрд░реЗрдВ

```bash
# MySQL рдореЗрдВ login рдХрд░реЗрдВ
mysql -u root -p

# Database рдмрдирд╛рдПрдВ
CREATE DATABASE eatsgram_db;
USE eatsgram_db;

# Character set set рдХрд░реЗрдВ
ALTER DATABASE eatsgram_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# Exit рдХрд░реЗрдВ
EXIT;
```

### Step 4: Configuration File рдмрдирд╛рдПрдВ

```bash
# File рдмрдирд╛рдПрдВ
touch src/config/database.js
```

```javascript
// src/config/database.js

const { Sequelize } = require('sequelize');

const sequelize = new Sequelize(
  process.env.DB_NAME,
  process.env.DB_USER,
  process.env.DB_PASSWORD,
  {
    host: process.env.DB_HOST,
    port: process.env.DB_PORT,
    dialect: 'mysql',
    logging: false,
    pool: {
      max: 10,
      min: 2,
      acquire: 30000,
      idle: 30000,
    },
  }
);

module.exports = sequelize;
```

### Step 5: Models рдмрдирд╛рдПрдВ

```bash
# Directory рдмрдирд╛рдПрдВ
mkdir -p src/models
```

```javascript
// src/models/User.js

const { DataTypes } = require('sequelize');
const sequelize = require('../config/database');

const User = sequelize.define('User', {
  id: {
    type: DataTypes.INTEGER,
    primaryKey: true,
    autoIncrement: true,
  },
  email: {
    type: DataTypes.STRING,
    unique: true,
    allowNull: false,
  },
  password: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  firstName: DataTypes.STRING,
  lastName: DataTypes.STRING,
  phone: DataTypes.STRING,
  role: {
    type: DataTypes.ENUM('customer', 'restaurant', 'rider', 'admin'),
    defaultValue: 'customer',
  },
  isActive: {
    type: DataTypes.BOOLEAN,
    defaultValue: true,
  },
}, {
  tableName: 'users',
  timestamps: true,
});

module.exports = User;
```

### Step 6: Sync рдХрд░реЗрдВ

```javascript
// src/app.js рдореЗрдВ add рдХрд░реЗрдВ

const sequelize = require('./config/database');

// Server start рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ
sequelize.sync({ alter: true })
  .then(() => {
    console.log('Database synced successfully!');
  })
  .catch((error) => {
    console.error('Database sync error:', error);
  });
```

---

## ЁЯУК Database Tables Create рдХрд░реЗрдВ

### SQL Script

```sql
-- Users Table
CREATE TABLE users (
  id INT PRIMARY KEY AUTO_INCREMENT,
  email VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  firstName VARCHAR(100),
  lastName VARCHAR(100),
  phone VARCHAR(20),
  role ENUM('customer', 'restaurant', 'rider', 'admin') DEFAULT 'customer',
  isActive BOOLEAN DEFAULT true,
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_email (email)
);

-- Restaurants Table
CREATE TABLE restaurants (
  id INT PRIMARY KEY AUTO_INCREMENT,
  userId INT NOT NULL,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  address VARCHAR(500),
  city VARCHAR(100),
  phone VARCHAR(20),
  rating DECIMAL(3, 2) DEFAULT 0,
  isActive BOOLEAN DEFAULT true,
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,
  INDEX idx_city (city)
);

-- Orders Table
CREATE TABLE orders (
  id INT PRIMARY KEY AUTO_INCREMENT,
  customerId INT NOT NULL,
  restaurantId INT NOT NULL,
  totalAmount DECIMAL(10, 2) NOT NULL,
  status ENUM('pending', 'confirmed', 'preparing', 'ready', 'on_way', 'delivered', 'cancelled') DEFAULT 'pending',
  paymentStatus ENUM('pending', 'completed', 'failed', 'refunded') DEFAULT 'pending',
  paymentMethod ENUM('card', 'wallet', 'cash', 'razorpay') DEFAULT 'card',
  razorpayOrderId VARCHAR(255),
  razorpayPaymentId VARCHAR(255),
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (customerId) REFERENCES users(id) ON DELETE CASCADE,
  FOREIGN KEY (restaurantId) REFERENCES restaurants(id) ON DELETE CASCADE,
  INDEX idx_status (status),
  INDEX idx_customerId (customerId)
);

-- Food Items Table
CREATE TABLE food_items (
  id INT PRIMARY KEY AUTO_INCREMENT,
  restaurantId INT NOT NULL,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  price DECIMAL(10, 2) NOT NULL,
  category VARCHAR(100),
  isVegetarian BOOLEAN DEFAULT false,
  isActive BOOLEAN DEFAULT true,
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (restaurantId) REFERENCES restaurants(id) ON DELETE CASCADE,
  INDEX idx_restaurantId (restaurantId)
);

-- Payments Table
CREATE TABLE payments (
  id INT PRIMARY KEY AUTO_INCREMENT,
  orderId INT NOT NULL,
  amount DECIMAL(10, 2) NOT NULL,
  paymentMethod ENUM('card', 'wallet', 'cash', 'razorpay') NOT NULL,
  status ENUM('pending', 'completed', 'failed', 'refunded') DEFAULT 'pending',
  razorpayOrderId VARCHAR(255),
  razorpayPaymentId VARCHAR(255),
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (orderId) REFERENCES orders(id) ON DELETE CASCADE,
  INDEX idx_status (status)
);
```

---

## ЁЯзк Testing

### Test рдХрд░реЗрдВ

```bash
# MySQL рдореЗрдВ login рдХрд░реЗрдВ
mysql -u root -p eatsgram_db

# Tables verify рдХрд░реЗрдВ
SHOW TABLES;

# User table structure рджреЗрдЦреЗрдВ
DESCRIBE users;

# Sample data insert рдХрд░реЗрдВ
INSERT INTO users (email, password, firstName, lastName, role)
VALUES ('test@example.com', 'hashed_password', 'John', 'Doe', 'customer');

# Data verify рдХрд░реЗрдВ
SELECT * FROM users;
```

---

## ЁЯФД MongoDB рд╕реЗ MySQL рдореЗрдВ Migrate рдХрд░реЗрдВ

### Migration Script

```javascript
// scripts/migrate-to-mysql.js

const mongoose = require('mongoose');
const sequelize = require('../src/config/database');
const User = require('../src/models/User');

async function migrate() {
  try {
    // MongoDB рд╕реЗ data fetch рдХрд░реЗрдВ
    const mongoUsers = await mongoose.model('User').find();
    
    console.log(`Migrating ${mongoUsers.length} users...`);
    
    // MySQL рдореЗрдВ insert рдХрд░реЗрдВ
    for (const user of mongoUsers) {
      await User.create({
        email: user.email,
        password: user.password,
        firstName: user.firstName,
        lastName: user.lastName,
        phone: user.phone,
        role: user.role,
        isActive: user.isActive,
      });
    }
    
    console.log('тЬЕ Migration completed successfully!');
    process.exit(0);
  } catch (error) {
    console.error('тЭМ Migration error:', error);
    process.exit(1);
  }
}

migrate();
```

### Run рдХрд░реЗрдВ

```bash
node scripts/migrate-to-mysql.js
```

---

## ЁЯФС GraphQL Integration

### Query рдмрдирд╛рдПрдВ

```graphql
query {
  getUser(id: 1) {
    id
    email
    firstName
    lastName
    role
  }
}
```

### Resolver рдмрдирд╛рдПрдВ

```javascript
// src/graphql/resolvers/user.resolver.js

const User = require('../../models/User');

const userResolvers = {
  Query: {
    getUser: async (_, { id }) => {
      return await User.findByPk(id);
    },
    
    getAllUsers: async () => {
      return await User.findAll();
    },
  },
  
  Mutation: {
    createUser: async (_, { email, password, firstName, lastName }) => {
      return await User.create({
        email,
        password,
        firstName,
        lastName,
      });
    },
    
    updateUser: async (_, { id, firstName, lastName }) => {
      const user = await User.findByPk(id);
      if (!user) throw new Error('User not found');
      
      return await user.update({ firstName, lastName });
    },
    
    deleteUser: async (_, { id }) => {
      const user = await User.findByPk(id);
      if (!user) throw new Error('User not found');
      
      await user.destroy();
      return true;
    },
  },
};

module.exports = userResolvers;
```

---

## ЁЯУИ Performance Tips

### 1. Indexes рдмрдирд╛рдПрдВ

```sql
-- Frequently searched columns рдкрд░
CREATE INDEX idx_email ON users(email);
CREATE INDEX idx_status ON orders(status);
CREATE INDEX idx_customerId ON orders(customerId);
```

### 2. Connection Pooling

```javascript
// рдкрд╣рд▓реЗ рд╕реЗ configured рд╣реИ config/database.js рдореЗрдВ
pool: {
  max: 10,      // Maximum connections
  min: 2,       // Minimum connections
  acquire: 30000,
  idle: 30000,
}
```

### 3. Query Optimization

```javascript
// тЬЕ Good: Select specific columns
const users = await User.findAll({
  attributes: ['id', 'email', 'firstName'],
});

// тЭМ Bad: Select all columns
const users = await User.findAll();
```

---

## ЁЯРЫ Common Issues

### Issue 1: Connection Refused

```
тЭМ Error: connect ECONNREFUSED 127.0.0.1:3306
тЬЕ Solution:
   1. MySQL service start рдХрд░реЗрдВ
   2. Host рдФрд░ port verify рдХрд░реЗрдВ
   3. Credentials check рдХрд░реЗрдВ
```

### Issue 2: Access Denied

```
тЭМ Error: Access denied for user 'root'@'localhost'
тЬЕ Solution:
   1. Password verify рдХрд░реЗрдВ
   2. MySQL restart рдХрд░реЗрдВ
```

### Issue 3: Database Not Found

```
тЭМ Error: Unknown database 'eatsgram_db'
тЬЕ Solution:
   1. Database create рдХрд░реЗрдВ
   2. .env рдореЗрдВ correct name рджреЗрдВ
```

---

## ЁЯУЭ Checklist

- [ ] MySQL installed
- [ ] Database created
- [ ] Packages installed
- [ ] Environment variables setup
- [ ] Configuration file created
- [ ] Models defined
- [ ] Tables created
- [ ] Data migrated (рдЕрдЧрд░ MongoDB рд╕реЗ)
- [ ] GraphQL resolvers created
- [ ] Testing completed

---

## ЁЯФЧ Useful Commands

```bash
# MySQL service start рдХрд░реЗрдВ
sudo systemctl start mysql

# MySQL рдореЗрдВ login рдХрд░реЗрдВ
mysql -u root -p

# Database list рджреЗрдЦреЗрдВ
SHOW DATABASES;

# Tables list рджреЗрдЦреЗрдВ
SHOW TABLES;

# Table structure рджреЗрдЦреЗрдВ
DESCRIBE table_name;

# Backup рд▓реЗрдВ
mysqldump -u root -p eatsgram_db > backup.sql

# Restore рдХрд░реЗрдВ
mysql -u root -p eatsgram_db < backup.sql
```

---

## ЁЯУЪ Next Steps

1. тЬЕ MySQL install рдХрд░реЗрдВ
2. тЬЕ Database create рдХрд░реЗрдВ
3. тЬЕ Packages install рдХрд░реЗрдВ
4. тЬЕ Configuration setup рдХрд░реЗрдВ
5. тЬЕ Models define рдХрд░реЗрдВ
6. тЬЕ Tables create рдХрд░реЗрдВ
7. тЬЕ Data migrate рдХрд░реЗрдВ (рдЕрдЧрд░ MongoDB рд╕реЗ)
8. тЬЕ GraphQL resolvers create рдХрд░реЗрдВ
9. тЬЕ Testing рдХрд░реЗрдВ
10. тЬЕ Production deploy рдХрд░реЗрдВ

---

**Last Updated**: October 16, 2025
**Time to Complete**: ~30 minutes
**Difficulty Level**: Beginner to Intermediate
